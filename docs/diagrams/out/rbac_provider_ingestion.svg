<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="783px" preserveAspectRatio="none" style="width:1334px;height:783px;" version="1.1" viewBox="0 0 1334 783" width="1334px" zoomAndPan="magnify"><defs><filter height="300%" id="fnydefid8wyxc" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="276" x="524.5" y="22.9951">RBAC Provider Ingestion Sequence</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="43" x2="43" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="112" x2="112" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="187" x2="187" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="291" x2="291" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="414.5" x2="414.5" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="560.5" x2="560.5" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="648.5" x2="648.5" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="874.5" x2="874.5" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="974.5" x2="974.5" y1="114.1875" y2="693.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1217.5" x2="1217.5" y1="114.1875" y2="693.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="8" y="110.8857">Azure AD</text><path d="M22.5,69.8906 L22.5,93.8906 M22.5,81.8906 L39.5,81.8906 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="51.5" cy="81.8906" fill="#FEFECE" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="8" y="705.4404">Azure AD</text><path d="M22.5,712.7422 L22.5,736.7422 M22.5,724.7422 L39.5,724.7422 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="51.5" cy="724.7422" fill="#FEFECE" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="91.5" y="110.8857">LDAP</text><path d="M92,69.8906 L92,93.8906 M92,81.8906 L109,81.8906 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="121" cy="81.8906" fill="#FEFECE" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="91.5" y="705.4404">LDAP</text><path d="M92,712.7422 L92,736.7422 M92,724.7422 L109,724.7422 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="121" cy="724.7422" fill="#FEFECE" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="147" y="110.8857">RethinkDB</text><path d="M169,61.8906 C169,51.8906 187,51.8906 187,51.8906 C187,51.8906 205,51.8906 205,61.8906 L205,87.8906 C205,97.8906 187,97.8906 187,97.8906 C187,97.8906 169,97.8906 169,87.8906 L169,61.8906 " fill="#ADD8E6" filter="url(#fnydefid8wyxc)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M169,61.8906 C169,71.8906 187,71.8906 187,71.8906 C187,71.8906 205,71.8906 205,61.8906 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="147" y="705.4404">RethinkDB</text><path d="M169,718.7422 C169,708.7422 187,708.7422 187,708.7422 C187,708.7422 205,708.7422 205,718.7422 L205,744.7422 C205,754.7422 187,754.7422 187,754.7422 C187,754.7422 169,754.7422 169,744.7422 L169,718.7422 " fill="#ADD8E6" filter="url(#fnydefid8wyxc)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M169,718.7422 C169,728.7422 187,728.7422 187,728.7422 C187,728.7422 205,728.7422 205,718.7422 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="237" y="94.5889">RBAC provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="256.5" y="110.8857">&lt;Azure&gt;</text><path d="M271,53.5938 L271,77.5938 M271,65.5938 L288,65.5938 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="300" cy="65.5938" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="237" y="705.4404">RBAC provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="256.5" y="721.7373">&lt;Azure&gt;</text><path d="M271,729.0391 L271,753.0391 M271,741.0391 L288,741.0391 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="300" cy="741.0391" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="360.5" y="94.5889">RBAC Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="382" y="110.8857">&lt;LDAP&gt;</text><path d="M394.5,53.5938 L394.5,77.5938 M394.5,65.5938 L411.5,65.5938 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="423.5" cy="65.5938" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="360.5" y="705.4404">RBAC Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="382" y="721.7373">&lt;LDAP&gt;</text><path d="M394.5,729.0391 L394.5,753.0391 M394.5,741.0391 L411.5,741.0391 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="423.5" cy="741.0391" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="528.5" y="110.8857">Validator</text><path d="M540.5,69.8906 L540.5,93.8906 M540.5,81.8906 L557.5,81.8906 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="569.5" cy="81.8906" fill="#D3D3D3" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="528.5" y="705.4404">Validator</text><path d="M540.5,712.7422 L540.5,736.7422 M540.5,724.7422 L557.5,724.7422 " fill="none" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="569.5" cy="724.7422" fill="#D3D3D3" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="624.5" y="78.292">RBAC</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="603.5" y="94.5889">Transaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="611" y="110.8857">Processor</text><ellipse cx="649" cy="49.2969" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="637" x2="661" y1="63.2969" y2="63.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="624.5" y="705.4404">RBAC</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="603.5" y="721.7373">Transaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="611" y="738.0342">Processor</text><ellipse cx="649" cy="757.3359" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="637" x2="661" y1="771.3359" y2="771.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="833.5" y="110.8857">LS Inbound</text><ellipse cx="875" cy="81.8906" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="863" x2="887" y1="95.8906" y2="95.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="833.5" y="705.4404">LS Inbound</text><ellipse cx="875" cy="724.7422" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="863" x2="887" y1="738.7422" y2="738.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="926.5" y="110.8857">LS Outbound</text><ellipse cx="974.5" cy="81.8906" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="962.5" x2="986.5" y1="95.8906" y2="95.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="926.5" y="705.4404">LS Outbound</text><ellipse cx="974.5" cy="724.7422" fill="#ADD8E6" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="962.5" x2="986.5" y1="738.7422" y2="738.7422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="21" x="1204" y="110.8857">???</text><ellipse cx="1217.5" cy="81.8906" fill="#FFA500" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1205.5" x2="1229.5" y1="95.8906" y2="95.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="21" x="1204" y="705.4404">???</text><ellipse cx="1217.5" cy="724.7422" fill="#FFA500" filter="url(#fnydefid8wyxc)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1205.5" x2="1229.5" y1="738.7422" y2="738.7422"/><rect fill="#EEEEEE" filter="url(#fnydefid8wyxc)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1319" x="3" y="144.7539"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1322" y1="144.7539" y2="144.7539"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1322" y1="147.7539" y2="147.7539"/><rect fill="#EEEEEE" filter="url(#fnydefid8wyxc)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="79" x="623" y="134.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="629" y="150.2544">inbound</text><polygon fill="#A80036" points="403,184.4531,413,188.4531,403,192.4531,407,188.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="112.5" x2="409" y1="188.4531" y2="188.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="119.5" y="183.3872">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="132.5" y="183.3872">Get changes</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="415" x2="457" y1="217.5859" y2="217.5859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="457" x2="457" y1="217.5859" y2="230.5859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="416" x2="457" y1="230.5859" y2="230.5859"/><polygon fill="#A80036" points="426,226.5859,416,230.5859,426,234.5859,422,230.5859" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="422" y="212.52">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="435" y="212.52">Transform payload</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="415" x2="457" y1="259.7188" y2="259.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="457" x2="457" y1="259.7188" y2="272.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="416" x2="457" y1="272.7188" y2="272.7188"/><polygon fill="#A80036" points="426,268.7188,416,272.7188,426,276.7188,422,272.7188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="422" y="254.6528">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="435" y="254.6528">Validate payload</text><polygon fill="#A80036" points="198,297.8516,188,301.8516,198,305.8516,194,301.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="192" x2="414" y1="301.8516" y2="301.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="204" y="296.7856">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="217" y="296.7856">Insert to inbound_queue table</text><polygon fill="#A80036" points="198,326.9844,188,330.9844,198,334.9844,194,330.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="192" x2="874" y1="330.9844" y2="330.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="204" y="325.9185">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="217" y="325.9185">Get message from inbound_queue table</text><polygon fill="#A80036" points="660,356.1172,650,360.1172,660,364.1172,656,360.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="654" x2="874" y1="360.1172" y2="360.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="666" y="355.0513">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="679" y="355.0513">Initialize sawtooth transaction</text><polygon fill="#A80036" points="572,385.25,562,389.25,572,393.25,568,389.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="566" x2="874" y1="389.25" y2="389.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="578" y="384.1841">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="591" y="384.1841">Create sawtooth transaction</text><rect fill="#EEEEEE" filter="url(#fnydefid8wyxc)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1319" x="3" y="417.8164"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1322" y1="417.8164" y2="417.8164"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1322" y1="420.8164" y2="420.8164"/><rect fill="#EEEEEE" filter="url(#fnydefid8wyxc)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="90" x="617.5" y="407.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="623.5" y="423.3169">outbound</text><polygon fill="#A80036" points="962.5,457.5156,972.5,461.5156,962.5,465.5156,966.5,461.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="561" x2="968.5" y1="461.5156" y2="461.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="568" y="456.4497">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="581" y="456.4497">Get complete transaction from changefeed</text><polygon fill="#A80036" points="198,486.6484,188,490.6484,198,494.6484,194,490.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="192" x2="973.5" y1="490.6484" y2="490.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="204" y="485.5825">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="217" y="485.5825">Update relevant tables</text><rect fill="#EEEEEE" filter="url(#fnydefid8wyxc)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1319" x="3" y="519.2148"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1322" y1="519.2148" y2="519.2148"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1322" y1="522.2148" y2="522.2148"/><rect fill="#EEEEEE" filter="url(#fnydefid8wyxc)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="60" x="632.5" y="508.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="638.5" y="524.7153">TODO</text><path d="M1118,546.7813 L1118,586.7813 L1313,586.7813 L1313,556.7813 L1303,546.7813 L1118,546.7813 " fill="#FFFFE0" filter="url(#fnydefid8wyxc)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1303,546.7813 L1303,556.7813 L1313,556.7813 L1303,546.7813 " fill="#FFFFE0" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="1124" y="563.8481">Need to prevent infinite</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="1124" y="578.981">loops from RBAC providers.</text><polygon fill="#808080" points="1205.5,613.1797,1215.5,617.1797,1205.5,621.1797,1209.5,617.1797" style="stroke: #808080; stroke-width: 1.0;"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="974.5" x2="1211.5" y1="617.1797" y2="617.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="981.5" y="612.1138">10</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="1003.5" y="612.1138">TODO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="1044.5" y="612.1138">: Remote outbound sync</text><polygon fill="#808080" points="123.5,642.3125,113.5,646.3125,123.5,650.3125,119.5,646.3125" style="stroke: #808080; stroke-width: 1.0;"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="117.5" x2="1216.5" y1="646.3125" y2="646.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="129.5" y="641.2466">11</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="151.5" y="641.2466">TODO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="192.5" y="641.2466">: Remote outbound sync</text><polygon fill="#808080" points="54,671.4453,44,675.4453,54,679.4453,50,675.4453" style="stroke: #808080; stroke-width: 1.0;"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="48" x2="1216.5" y1="675.4453" y2="675.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="60" y="670.3794">12</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="82" y="670.3794">TODO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="123" y="670.3794">: Remote outbound sync</text><!--
@startuml
hide stereotype
    scale 1

    skinparam database {
        BackgroundColor<<NEXT>> lightblue
        BorderColor<<NEXT>> darkblue
        BackgroundColor<<HYPERLEDGER>> lightgrey
        BorderColor<<HYPERLEDGER>> darkgrey
    }
    skinparam entity {
        BackgroundColor<<NEXT>> lightblue
        BorderColor<<NEXT>> darkblue
        BackgroundColor<<HYPERLEDGER>> Lightgrey
        BorderColor<<HYPERLEDGER>> darkgrey
    }
    skinparam boundary {
        BackgroundColor<<NEXT>> lightblue
        BorderColor<<NEXT>> darkblue
        BackgroundColor<<HYPERLEDGER>> Lightgrey
        BorderColor<<HYPERLEDGER>> darkgrey
    }

    boundary "Azure AD" as azure
    boundary "LDAP" as ldap
    database "RethinkDB" as rethink <<NEXT>>
    boundary "RBAC provider \n<Azure>" as azure_provider <<NEXT>>
    boundary "RBAC Provider \n<LDAP>" as ldap_provider <<NEXT>>
    boundary "Validator" as validator <<HYPERLEDGER>>
    entity "RBAC \nTransaction \nProcessor" as tp<<NEXT>>
    entity "LS Inbound" as ls_in <<NEXT>>
    entity "LS Outbound" as ls_out <<NEXT>>
    entity "???" #orange

title RBAC Provider Ingestion Sequence
== inbound ==
autonumber
ldap -> ldap_provider: Get changes
ldap_provider -> ldap_provider: Transform payload
ldap_provider -> ldap_provider: Validate payload
ldap_provider -> rethink: Insert to inbound_queue table
ls_in -> rethink: Get message from inbound_queue table
ls_in -> tp: Initialize sawtooth transaction
ls_in -> validator: Create sawtooth transaction
== outbound ==
validator -> ls_out: Get complete transaction from changefeed
ls_out -> rethink: Update relevant tables
== TODO ==
note over "???" #lightyellow
    Need to prevent infinite
    loops from RBAC providers.
end note
ls_out - -[#grey]> "???": **TODO**: Remote outbound sync
"???" - -[#grey]> ldap: **TODO**: Remote outbound sync
"???" - -[#grey]> azure: **TODO**: Remote outbound sync
@enduml

PlantUML version 1.2019.05(Sat Apr 20 16:45:36 UTC 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>